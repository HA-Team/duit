<div ng-controller="listing" id="listing">
<!-- Content
================================================== -->
<div class="container margin-top-50" >
  <!-- <div class="row fullwidth-layout" ng-show="ifResults"> -->

  <!-- Sidebar
    ================================================== -->
    <div class="col-md-3 sidebar-col">
      <div class="sidebar sticky right">
        <!-- Widget -->
        <div class="widget margin-bottom-40">
          <h3 class="margin-top-0 margin-bottom-35">Filtrar búsqueda</h3>
          <!-- Row -->
          <div class="row with-forms">
            <div class="col-md-12">
              <label class="text-primary">Rango de precio</label>
            </div>
            <!-- Min Price -->
            <div class="col-md-6">
              <input type="text" placeholder="Min." data-unit="USD" ng-model="minPrice" ng-model-options='{ debounce: 1500 }' ng-change="find()">
            </div>
            <!-- Max Price -->
            <div class="col-md-6">
              <input type="text" placeholder="Max." data-unit="USD" ng-model="maxPrice" ng-model-options='{ debounce: 1500 }' ng-change="find()">
            </div>
          </div>
          <div class="row with-forms">
            <!-- Status -->
            <div class="col-md-12">
              <label class="text-primary">Operación</label>
              <h4 class="badge badge-default" ng-if="sideBarParams.operations.length == 1" ng-repeat="o in sideBarParams.operations">
                {{opName(o.operation_type)}} <span class="badge badge-danger" ng-click="changeFilter({type: 'o', val: [1,2]})"><i class="fa fa-times"></i></span>
              </h4>
              <h4 class="badge badge-info" ng-if="sideBarParams.operations.length > 1" ng-repeat="o in sideBarParams.operations"
              ng-click="changeFilter({type: 'o', val: [o.id]})">
                {{opName(o.operation_type)}} ({{o.count}})</i></span>
              </h4>
            </div>
          </div>
          <div class="row with-forms">
            <!-- Type -->
            <div class="col-md-12">
              <label class="text-primary">Tipo</label> 
                <h4 class="badge badge-default" ng-if="sideBarParams.types.length == 1" ng-repeat="t in sideBarParams.types">
                  {{t.type}} <span class="badge badge-danger" ng-click="changeFilter({type: 't', val: [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25]})"><i class="fa fa-times"></i></span>
                </h4>
                <h4 class="badge badge-info" ng-if="sideBarParams.types.length > 1" ng-repeat="t in sideBarParams.types" ng-click="changeFilter({type: 't', val: [t.id]})">
                  {{t.type}} ({{t.count}})</i></span>
                </h4>
            </div>
          </div>
          <div class="row with-forms" ng-if="sideBarParams.types.length == 1">
            <div class="col-md-12">
              <label class="text-primary">Condición</label>
              <h4 class="badge badge-default" ng-if="sideBarParams.subTypes.length == 1" ng-repeat="st in sideBarParams.subTypes">
                {{st.name}} <span class="badge badge-danger" ng-click="changeFilter({type: 'st', val: []})"><i class="fa fa-times"></i></span>
              </h4>
              <h4 class="badge badge-info" ng-if="sideBarParams.subTypes.length > 1" ng-repeat="st in sideBarParams.subTypes" ng-click="changeFilter({type: 'st', val: [st.id]})">
                {{st.name}}</i></span>
              </h4>
            </div>
          </div>
          <div class="row with-forms">
            <!-- Cities -->
            <div class="col-md-12">
              <label class="text-primary">Ciudad/Barrio</label>
              <h4 class="badge badge-default" ng-if="sideBarParams.locations.length == 1" ng-repeat="l in sideBarParams.locations">
                {{l.location_name}}<span class="badge badge-danger" ng-click="changeFilter({type: 'l', val: []})"><i class="fa fa-times"></i></span>
              </h4>
              <h4 class="badge badge-info" ng-if="sideBarParams.locations.length > 1" ng-repeat="l in sideBarParams.locations" ng-click="changeFilter({type: 'l', val: [l.location_id]})">
                {{l.location_name}} ({{l.count}})</i></span>
              </h4>
            </div>
          </div>
          <div class="row with-forms">
            <!-- Cities -->
            <div class="col-md-12">
              <label class="text-primary">Dormitorios</label>
              <h4 class="badge badge-default" ng-if="sideBarParams.rooms.length == 1" ng-repeat="r in sideBarParams.rooms">
                {{roomAmtName(r.amount)}}<span class="badge badge-danger" ng-click="changeFilter({type: 'r', val: []})"><i class="fa fa-times"></i></span>
              </h4>
              <h4 class="badge badge-info" ng-if="sideBarParams.rooms.length > 1" ng-repeat="r in sideBarParams.rooms" ng-click="changeFilter({type: 'r', val: ['suite_amount', '=', r.amount.toString()]})">
                {{roomAmtName(r.amount)}} ({{r.count}})</i></span>
              </h4>
            </div>
          </div>
          <!-- <button class="button fullwidth margin-top-30">Search</button> -->
        </div>
        <!-- Widget / End -->

      </div>
    </div>
    <!-- Sidebar / End -->
    <div class='spinner' ng-include="'/views/common/spinner.html'" ng-hide="apiReady"></div>
    <div class="col-md-9" ng-show="apiReady">

      <!-- Sorting / Layout Switcher -->
      <div class="row margin-bottom-15">

        <div class="col-md-6">
          <!-- Sort by -->
          <div class="sort-by">
            <label>{{resultsCount}} Propiedades encontradas</label>

            <!-- <div class="sort-by-select">
              <select data-placeholder="Default order" class="chosen-select-no-single" > 
                <option>Mayor Precio</option>
                <option>Menor Precio</option>
                <option>Más Recientes</option>
              </select>
            </div> -->
          </div>
        </div>

        <div class="col-md-6">
          <!-- Layout Switcher -->
          <div class="layout-switcher">
            <a href="#" class="grid-three"><i class="fa fa-th"></i></a>
            <a href="#" class="grid"><i class="fa fa-th-large"></i></a>
            <a href="#" class="list"><i class="fa fa-th-list"></i></a>
          </div>
        </div>
      </div>
      <!-- Listings -->
      <div class="listings-container grid-layout-three" infinite-scroll="loadMoreProps()" infinite-scroll-distance="2" infinite-scroll-immediate-check='false'>
        <!-- Listing Item -->
        <div class="listing-item " ng-repeat="p in results">

          <a class="listing-img-container" href="/#!/property/{{p.id}}">

            <div class="listing-badges">
              <!-- <span class="featured">Featured</span> -->
              <span>{{p.type}}</span>
            </div>

            <div class="listing-img-content">
              <span class="listing-price">{{p.currency}} {{p.price}}</span>
              <!-- <span class="like-icon tooltip"></span> -->
            </div>

            <div class="listing-carousel">
              <div ng-repeat="photo in p.photos"><img src="{{photo.image}}" alt="" ></div>
              <!-- <div><img src="images/listing-01b.jpg" alt=""></div>
              <div><img src="images/listing-01c.jpg" alt=""></div> -->
            </div>
          </a>
          
          <div class="listing-content">

            <div class="listing-title">
              <h4><a ui-sref="property({propertyId: p.id})">{{p.title}}</a></h4>
              <a href="https://maps.google.com/maps?q=221B+Baker+Street,+London,+United+Kingdom&hl=en&t=v&hnear=221B+Baker+St,+London+NW1+6XE,+United+Kingdom" class="listing-address popup-gmaps">
                <i class="fa fa-map-marker"></i>
                {{p.address}}
              </a>

              <a ui-sref="property({propertyId: p.id})" class="details button border">Detalles</a>
            </div>

            <ul class="listing-details">
              <li>{{p.area}} M2</li>
              <li><i class="fa fa-bed"></i> {{p.rooms}}</li>
              <li><i class="fa fa-bath"></i> {{p.baths}}</li>
              <li><i class="fa fa-car"></i> {{p.parkings}}</li>
            </ul>

            <div class="listing-footer">
              <a href="#"><i class="fa fa-user"></i> {{p.agent}}</a>
              <!-- <span><i class="fa fa-calendar-o"></i> 1 day ago</span> -->
            </div>

          </div>

        </div>
        <!-- Listing Item / End -->
      </div>
      <!-- Listings Container / End -->

      <div class="clearfix"></div>
    </div>
    <div class="row fullwidth-layout text-center no-results" ng-hide="ifResults">
      <i class="fa fa-5x fa-frown-o"></i>
      <h3>¡Ups! No hay nada aquí. ¡<a href="#!/contactUs">Contactános</a> para ver mas opciones!</h3>
    </div> 
  </div>
  
</div>
</div>